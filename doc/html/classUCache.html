<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ULib C++ Library: UCache Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>UCache Class Reference</h1><!-- doxytag: class="UCache" -->
<p><a class="el" href="classUCache.html" title="UCache is a structure for fixed-size cache.">UCache</a> is a structure for fixed-size cache.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cache_8h_source.html">cache.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for UCache:</div>
<div class="dynsection">
<div class="center"><img src="classUCache__coll__graph.png" border="0" usemap="#UCache_coll__map" alt="Collaboration graph"/></div>
<map name="UCache_coll__map" id="UCache_coll__map">
<area shape="rect" id="node2" href="structUCache_1_1cache__info.html" title="UCache::cache_info" alt="" coords="5,6,136,34"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classUCache-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUCache_1_1cache__hash__table__entry.html">cache_hash_table_entry</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUCache_1_1cache__info.html">cache_info</a></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32554ebd2dd950a3c59fafbf19c91fbc"></a><!-- doxytag: member="UCache::set" ref="a32554ebd2dd950a3c59fafbf19c91fbc" args="(char *ptr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>set</b> (char *ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b70b2eafc303a5cb44024ddd2147e5e"></a><!-- doxytag: member="UCache::initStart" ref="a5b70b2eafc303a5cb44024ddd2147e5e" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>initStart</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa860e7d46cd24bff5d1bf4d1616d41c7"></a><!-- doxytag: member="UCache::init" ref="aa860e7d46cd24bff5d1bf4d1616d41c7" args="(uint32_t size)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>init</b> (uint32_t size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac04f6d5c06551e9e5667fb8b5a9a149c"></a><!-- doxytag: member="UCache::open" ref="ac04f6d5c06551e9e5667fb8b5a9a149c" args="(const UString &amp;path, uint32_t size)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>open</b> (const <a class="el" href="classUString.html">UString</a> &amp;path, uint32_t size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ea375a9f0d856b08dcb3096f537c095"></a><!-- doxytag: member="UCache::add" ref="a2ea375a9f0d856b08dcb3096f537c095" args="(const UString &amp;_key, const UString &amp;_data, uint32_t ttl=0)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>add</b> (const <a class="el" href="classUString.html">UString</a> &amp;_key, const <a class="el" href="classUString.html">UString</a> &amp;_data, uint32_t ttl=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac617116ecb3d7c9dc725568a0c0209e5"></a><!-- doxytag: member="UCache::operator[]" ref="ac617116ecb3d7c9dc725568a0c0209e5" args="(const UString &amp;key)" -->
<a class="el" href="classUString.html">UString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>operator[]</b> (const <a class="el" href="classUString.html">UString</a> &amp;key)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a60bf3d47afef227efe3bd8480bd9efb4"></a><!-- doxytag: member="UCache::contentOf" ref="a60bf3d47afef227efe3bd8480bd9efb4" args="(const char *fmt,...)" -->
<a class="el" href="classUString.html">UString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>contentOf</b> (const char *fmt,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d46b74fdd36faca121733bfadfb6bae"></a><!-- doxytag: member="UCache::addContentOf" ref="a4d46b74fdd36faca121733bfadfb6bae" args="(const UString &amp;pathname)" -->
<a class="el" href="classUString.html">UString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>addContentOf</b> (const <a class="el" href="classUString.html">UString</a> &amp;pathname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afbaed32c9550668e0b3f72e64164a199"></a><!-- doxytag: member="UCache::loadContentOf" ref="afbaed32c9550668e0b3f72e64164a199" args="(const UString &amp;directory)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>loadContentOf</b> (const <a class="el" href="classUString.html">UString</a> &amp;directory)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e893c4d1dc10b434b7cc7651a0b96c1"></a><!-- doxytag: member="UCache::reset" ref="a9e893c4d1dc10b434b7cc7651a0b96c1" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>reset</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb8710e3b4c0d12ac0a48ded4cc114cf"></a><!-- doxytag: member="UCache::getTTL" ref="acb8710e3b4c0d12ac0a48ded4cc114cf" args="() const " -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>getTTL</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad0f80f2e9ee1c19e50b9b1192c33069d"></a><!-- doxytag: member="UCache::getTime" ref="ad0f80f2e9ee1c19e50b9b1192c33069d" args="() const " -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>getTime</b> () const </td></tr>
<tr><td colspan="2"><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3b3eb17d1bcec8ff4794a8c3d859a952"></a><!-- doxytag: member="UCache::cache_info" ref="a3b3eb17d1bcec8ff4794a8c3d859a952" args="" -->
typedef struct <a class="el" href="structUCache_1_1cache__info.html">UCache::cache_info</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>cache_info</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4c39e482e7c0a632ab67123305fe970c"></a><!-- doxytag: member="UCache::cache_hash_table_entry" ref="a4c39e482e7c0a632ab67123305fe970c" args="" -->
typedef struct <br class="typebreak"/>
<a class="el" href="structUCache_1_1cache__hash__table__entry.html">UCache::cache_hash_table_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>cache_hash_table_entry</b></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8fedf660575d9cc09e8df370da0c79cd"></a><!-- doxytag: member="UCache::getLink" ref="a8fedf660575d9cc09e8df370da0c79cd" args="(uint32_t pos) const " -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>getLink</b> (uint32_t pos) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a25451673568205bd86a5e17c480eb0"></a><!-- doxytag: member="UCache::setHead" ref="a9a25451673568205bd86a5e17c480eb0" args="(uint32_t pos, uint32_t value)" -->
<a class="el" href="structUCache_1_1cache__hash__table__entry.html">cache_hash_table_entry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>setHead</b> (uint32_t pos, uint32_t value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a02502fe7d74d6ca68ffa6b7ae71f6491"></a><!-- doxytag: member="UCache::entry" ref="a02502fe7d74d6ca68ffa6b7ae71f6491" args="(uint32_t pos) const " -->
<a class="el" href="structUCache_1_1cache__hash__table__entry.html">cache_hash_table_entry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>entry</b> (uint32_t pos) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31376d8a10429da3a021c1127a4f1e66"></a><!-- doxytag: member="UCache::replace" ref="a31376d8a10429da3a021c1127a4f1e66" args="(uint32_t pos, uint32_t value)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>replace</b> (uint32_t pos, uint32_t value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a764735a60e394de8aa05f0592ab9c686"></a><!-- doxytag: member="UCache::add" ref="a764735a60e394de8aa05f0592ab9c686" args="(const char *key, uint32_t keylen, uint32_t datalen, uint32_t ttl)" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>add</b> (const char *key, uint32_t keylen, uint32_t datalen, uint32_t ttl)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a43d291e0a690a2b17088ad7f2af1da3d"></a><!-- doxytag: member="UCache::print" ref="a43d291e0a690a2b17088ad7f2af1da3d" args="(ostream &amp;os, uint32_t &amp;pos) const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>print</b> (ostream &amp;os, uint32_t &amp;pos) const </td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a65c9e0d1da46c5ffcd6a2990f491a12f"></a><!-- doxytag: member="UCache::x" ref="a65c9e0d1da46c5ffcd6a2990f491a12f" args="" -->
char *&nbsp;</td><td class="memItemRight" valign="bottom"><b>x</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a96e9ac72c4a64028014024f8d508f32e"></a><!-- doxytag: member="UCache::info" ref="a96e9ac72c4a64028014024f8d508f32e" args="" -->
<a class="el" href="structUCache_1_1cache__info.html">cache_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>info</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abb2b83c007344d61cca682606f52c607"></a><!-- doxytag: member="UCache::start" ref="abb2b83c007344d61cca682606f52c607" args="" -->
time_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>start</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af109d7d3a1a9c3b6fc407c0168435749"></a><!-- doxytag: member="UCache::ttl" ref="af109d7d3a1a9c3b6fc407c0168435749" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>ttl</b></td></tr>
<tr><td colspan="2"><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c7b62e84067008b791350f7a56aebed"></a><!-- doxytag: member="UCache::operator&gt;&gt;" ref="a3c7b62e84067008b791350f7a56aebed" args="(istream &amp;is, UCache &amp;c)" -->
U_EXPORT istream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>operator&gt;&gt;</b> (istream &amp;is, <a class="el" href="classUCache.html">UCache</a> &amp;c)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af7b2d7355dd2e4887de297b75816d7ec"></a><!-- doxytag: member="UCache::operator&lt;&lt;" ref="af7b2d7355dd2e4887de297b75816d7ec" args="(ostream &amp;os, const UCache &amp;c)" -->
U_EXPORT ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>operator&lt;&lt;</b> (ostream &amp;os, const <a class="el" href="classUCache.html">UCache</a> &amp;c)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classUCache.html" title="UCache is a structure for fixed-size cache.">UCache</a> is a structure for fixed-size cache. </p>
<p>The first part of cache is a hash tables with (hsize / sizeof(uint32_t)) pointers to consecutive bucket linked lists. +--------------------+--------------------------+------------+ | p0 p1 ... phsize-1 | entry0 entry1 ... entryn | free space | +--------------------+--------------------------+------------+ The internal data structure of cache is the following structure:</p>
<p>x[ 0....hsize-1] hsize / sizeof(uint32_t) head links. x[hsize....writer-1] consecutive entries, newest entry on the right. x[writer...oldest-1] free space for new entries. x[oldest...unused-1] consecutive entries, oldest entry on the left. x[unused...size-1] unused.</p>
<p>Each hash bucket is a linked list containing the following items: the head link, the newest entry, the second-newest entry, etc. Each link is a 4-byte number giving the xor of the positions of the adjacent items in the list. Entries are always inserted immediately after the head and removed at the tail. Each entry contains the following information: struct <a class="el" href="structUCache_1_1cache__hash__table__entry.html">cache_hash_table_entry</a> + key + data. </p>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/ulib/<a class="el" href="cache_8h_source.html">cache.h</a></li>
<li>src/ulib/cache.cpp</li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Dec 24 13:47:00 2009 for ULib C++ Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
